<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>An Introduction to Multi-Armed Bandit Problem and Solutions | Golden Hat</title>

<meta name="keywords" content="" />
<meta name="description" content="Multi-Armed Bandit Problem Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward at one play. The question is What&rsquo;s the strategy to get the highest long-term reward?
An illustration of multi-armed bandit problem, refer to Lil&rsquo;Log The Multi-Armed Bandit Problem and Its Solutions
Definition Upper Confidence Bounds(UCB) The UCB algorithm give a realtion between upper bound and probability confidence.">
<meta name="author" content="">
<link rel="canonical" href="https://frankccccc.github.io/blog/posts/bandit/" />
<link href="https://frankccccc.github.io/blog/assets/css/stylesheet.min.f1bbfae023539c16ac553a8e32caeefc657000612d2bcc3d4cd998f504582f36.css" integrity="sha256-8bv64CNTnBasVTqOMsru/GVwAGEtK8w9TNmY9QRYLzY=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://frankccccc.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://frankccccc.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://frankccccc.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://frankccccc.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://frankccccc.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.80.0" />


<meta property="og:title" content="An Introduction to Multi-Armed Bandit Problem and Solutions" />
<meta property="og:description" content="Multi-Armed Bandit Problem Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward at one play. The question is What&rsquo;s the strategy to get the highest long-term reward?
An illustration of multi-armed bandit problem, refer to Lil&rsquo;Log The Multi-Armed Bandit Problem and Its Solutions
Definition Upper Confidence Bounds(UCB) The UCB algorithm give a realtion between upper bound and probability confidence." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://frankccccc.github.io/blog/posts/bandit/" />
<meta property="og:image" content="https://frankccccc.github.io/blog/img/just_imgs/grassland.jpg" /><meta property="article:published_time" content="2021-02-16T20:11:41+08:00" />
<meta property="article:modified_time" content="2021-02-16T20:11:41+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://frankccccc.github.io/blog/img/just_imgs/grassland.jpg" />
<meta name="twitter:title" content="An Introduction to Multi-Armed Bandit Problem and Solutions"/>
<meta name="twitter:description" content="Multi-Armed Bandit Problem Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward at one play. The question is What&rsquo;s the strategy to get the highest long-term reward?
An illustration of multi-armed bandit problem, refer to Lil&rsquo;Log The Multi-Armed Bandit Problem and Its Solutions
Definition Upper Confidence Bounds(UCB) The UCB algorithm give a realtion between upper bound and probability confidence."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://frankccccc.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "An Introduction to Multi-Armed Bandit Problem and Solutions",
      "item": "https://frankccccc.github.io/blog/posts/bandit/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "An Introduction to Multi-Armed Bandit Problem and Solutions",
  "name": "An Introduction to Multi-Armed Bandit Problem and Solutions",
  "description": "Multi-Armed Bandit Problem Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward …",
  "keywords": [
    
  ],
  "articleBody": "Multi-Armed Bandit Problem Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward at one play. The question is What’s the strategy to get the highest long-term reward?\nAn illustration of multi-armed bandit problem, refer to Lil’Log The Multi-Armed Bandit Problem and Its Solutions\nDefinition Upper Confidence Bounds(UCB) The UCB algorithm give a realtion between upper bound and probability confidence. That is to say, the UCB gives How likely is the real value of a random variable below the upper bound? To achieve this goal, we need to understand Hoeffding’s Inequality first.\nHoeffding’s Inequality Let $X_1,…,X_t$ be i.i.d. (independent and identically distributed) random variables and they are all bounded by the interval $[0, 1]$. The sample mean is\n$\\overline{X}_t = \\frac{1}{t} \\sum_{\\tau=1}^t X_\\tau$ Then for $u  0$, we have:\n$$ \\mathbb{P} [ \\mathbb{E}[X]  \\overline{X}_t + u] \\leq e^{-2tu^2} $$\nThe inequation gives an upper bound in probability. Once the probability is small enough, we can say the upper bound is correct almost surely.\nCombine the Hoeffding’s Inequality and our goal. We can dervie\n$$ \\mathbb{P} [ Q(a)  \\hat{Q}_t(a) + U_t(a)] \\leq e^{-2t{U_t(a)}^2} $$\nOnce we get the bound, we can specify a target confidnce and always choose the action having highest upper bound.\n$$ a^{UCB}t = argmax{a \\in \\mathcal{A}} \\hat{Q}_t(a) + \\hat{U}_t(a) $$\nUCB1 Algorithm Since we want to measure the confidence of the upper bound, we can derive the confidence with the times of acting.\n$$ U_t(a) = \\sqrt{\\frac{2 \\log t}{N_t(a)}} \\text{ and } a^{UCB1}t = \\arg\\max{a \\in \\mathcal{A}} Q(a) + \\sqrt{\\frac{2 \\log t}{N_t(a)}} $$\n",
  "wordCount" : "275",
  "inLanguage": "en",
  "image":"https://frankccccc.github.io/blog/img/just_imgs/grassland.jpg","datePublished": "2021-02-16T20:11:41+08:00",
  "dateModified": "2021-02-16T20:11:41+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://frankccccc.github.io/blog/posts/bandit/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Golden Hat",
    "logo": {
      "@type": "ImageObject",
      "url": "https://frankccccc.github.io/blog/favicon.ico"
    }
  }
}
</script>





</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://frankccccc.github.io/blog/" accesskey="h" title="Golden Hat (Alt + H)">Golden Hat</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                
                
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()"></ul>
    </nav>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
  
    window.addEventListener('load', (event) => {
        document.querySelectorAll("mjx-container").forEach(function(x){
          x.parentElement.classList += 'has-jax'})
      });
  
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">

    <h1 class="post-title">
      An Introduction to Multi-Armed Bandit Problem and Solutions<div class="entry-isdraft"><sup>&nbsp;&nbsp;[draft]</sup></div>
    </h1>
    <div class="post-meta">February 16, 2021

</div>
  </header> 
<figure class="entry-cover"><img src="https://frankccccc.github.io/blog/img/just_imgs/grassland.jpg" alt="">
        
</figure>

  <div class="post-content">
<h1 id="multi-armed-bandit-problem">Multi-Armed Bandit Problem<a hidden class="anchor" aria-hidden="true" href="#multi-armed-bandit-problem">#</a></h1>
<p>Imagine you are in a casionoand face multiple slot machines. Each machine is configured with an unknown probability of how likely you would get a reward at one play. The question is <strong>What&rsquo;s the strategy to get the highest long-term reward?</strong></p>
<p><img src="https://frankccccc.github.io/blog/img/gp/bern_bandit.png" alt="">
<em>An illustration of multi-armed bandit problem, refer to <a href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html">Lil&rsquo;Log The Multi-Armed Bandit Problem and Its Solutions</a></em></p>
<h2 id="definition">Definition<a hidden class="anchor" aria-hidden="true" href="#definition">#</a></h2>
<h2 id="upper-confidence-boundsucb">Upper Confidence Bounds(UCB)<a hidden class="anchor" aria-hidden="true" href="#upper-confidence-boundsucb">#</a></h2>
<p>The UCB algorithm give a realtion between upper bound and probability confidence. That is to say, the UCB gives <strong>How likely is the real value of a random variable below the upper bound?</strong> To achieve this goal, we need to understand <a href="https://en.wikipedia.org/wiki/Hoeffding%27s_inequality">Hoeffding’s Inequality</a> first.</p>
<h3 id="hoeffdings-inequality">Hoeffding’s Inequality<a hidden class="anchor" aria-hidden="true" href="#hoeffdings-inequality">#</a></h3>
<p>Let $X_1,…,X_t$ be i.i.d. (independent and identically distributed) random variables and they are all bounded by the interval $[0, 1]$. The sample mean is</p>
<h3 id="overlinex_t--frac1t-sum_tau1t-x_tau"><code>$\overline{X}_t = \frac{1}{t} \sum_{\tau=1}^t X_\tau$</code><a hidden class="anchor" aria-hidden="true" href="#overlinex_t--frac1t-sum_tau1t-x_tau">#</a></h3>
<p>Then for $u &gt; 0$, we have:</p>
<p>$$ \mathbb{P} [ \mathbb{E}[X] &gt; \overline{X}_t + u] \leq e^{-2tu^2} $$</p>
<!-- raw HTML omitted -->
<p>The inequation gives an upper bound in probability. Once the probability is small enough, we can say the upper bound is correct <strong><a href="https://en.wikipedia.org/wiki/Almost_surely">almost surely</a></strong>.</p>
<p>Combine the Hoeffding’s Inequality and our goal. We can dervie</p>
<p>$$ \mathbb{P} [ Q(a) &gt; \hat{Q}_t(a) + U_t(a)] \leq e^{-2t{U_t(a)}^2} $$</p>
<!-- raw HTML omitted -->
<p>Once we get the bound, we can specify a target confidnce and always choose the action having highest upper bound.</p>
<p>$$ a^{UCB}t = argmax{a \in \mathcal{A}} \hat{Q}_t(a) + \hat{U}_t(a) $$</p>
<!-- raw HTML omitted -->
<h3 id="ucb1-algorithm">UCB1 Algorithm<a hidden class="anchor" aria-hidden="true" href="#ucb1-algorithm">#</a></h3>
<p>Since we want to measure the confidence of the upper bound, we can derive the confidence with the times of acting.</p>
<p>$$ U_t(a) = \sqrt{\frac{2 \log t}{N_t(a)}} \text{ and } a^{UCB1}t = \arg\max{a \in \mathcal{A}} Q(a) + \sqrt{\frac{2 \log t}{N_t(a)}} $$</p>
<!-- raw HTML omitted -->

</div>
  <footer class="post-footer">
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://frankccccc.github.io/blog/">Golden Hat</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script defer src="https://frankccccc.github.io/blog/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
